<!doctype html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>MiniLoom</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta
      http-equiv="Content-Security-Policy"
      content="default-src 'self'; script-src 'self'; style-src 'self' 'unsafe-inline'; img-src 'self' data:; connect-src *;"
    />
    <link rel="stylesheet" href="main.css" />
  </head>
  <body>
    <div id="tree-stats-tooltip" class="tooltip" style="display: none;"></div>
    <div id="main-content" class="main-content">
      <div id="narrative-pane" class="narrative-pane">
        <div id="top-bar" class="top-bar">
          <div class="top-bar-content">
            <div class="logo-title">
              <img
                src="../assets/minihf_logo_no_text.png"
                alt="MiniHF Logo"
                class="app-logo"
              />
              <span class="app-title">MiniHF MiniLoom</span>
            </div>
            <div class="file-info">
              <div class="file-title-row">
                <span id="current-filename" class="current-filename"
                  >Unsaved</span
                >
              </div>
              <div id="tree-stats" class="tree-stats">
                <span id="file-author" class="author-info"
                  ><span>👤</span><span id="author-name">Author</span></span
                >
                <span id="tree-stats-summary" class="tree-stats-summary">
                  🍃 <span id="tree-total-nodes">0</span> nodes
                </span>
              </div>
            </div>
          </div>
        </div>

        <div id="focused-node-content">
          <textarea
            id="editor"
            class="editor"
            placeholder="Your prompt goes here."
          ></textarea>
          <div id="editor-footer" class="editor-footer">
            <div id="editor-stats" class="editor-stats">
              <span title="Word count"><span id="editor-word-count">0</span><span title="Net word change" id="editor-word-change">(+0)</span> words</span>
              <span title="Character count"><span id="editor-char-count">0</span><span title="Net character change" id="editor-char-change">(+0)</span> chars</span>
            </div>

          </div>
        </div>

        <div id="errors" class="errors">
          <div class="error-content">
            <p id="error-message" class="error-message"></p>
            <button id="error-close" class="error-close" title="Clear error">
              ×
            </button>
          </div>
        </div>

        <div id="controls" class="controls">
          <div id="controls-left" class="controls-left">
            <div id="thumbs-display" class="thumbs-display">
              <span id="thumb-up" class="thumbs">👍</span>
              <span id="thumb-down" class="thumbs">👎</span>
            </div>
            <div id="node-stats-display" class="node-stats-display">
              <div class="node-info-line">
                <span title="Node ID" id="node-position">📍 1: </span>
                <span title="Node summary" id="node-summary">Untitled</span>
              </div>
              <div class="node-info-line metadata-line">
                <span title="Author"><span id="node-author-emoji">👤</span><span id="node-author">Unknown</span></span>
              </div>
              <div class="node-info-line metadata-line">
                <span title="Last updated time" id="node-timestamp">🕐 N/A</span>
              </div>
              <div class="node-info-line metadata-line">
                <span title="Depth in the tree" id="node-metadata">📏 0</span>
                <span id="finish-reason" class="finish-reason" style="display: none;"></span>
                <span id="subtree-info" class="subtree-info" style="display: none;">
                  🍃 <span id="subtree-total">0</span>
                </span>
              </div>
            </div>
          </div>

          <div id="controls-right" class="controls-right">
            <div id="generation-controls">
              <div class="control-group">
                <label for="service-selector" title="Service">🌐</label>
                <select id="service-selector">
                  <option value="">-- Select Service --</option>
                </select>
              </div>
              <div class="control-group">
                <label for="api-key-selector" title="API Key">🔑</label>
                <select id="api-key-selector">
                  <option value="">-- Select API key --</option>
                </select>
              </div>
              <div class="control-group">
                <label for="sampler-selector" title="Sampler">🎲</label>
                <select id="sampler-selector">
                  <option value="">-- Select a sampler --</option>
                </select>
              </div>
            </div>

            <div class="generate-section">
              <div id="favorites-container" class="favorites-container">
                <!-- Favorites buttons will be populated by JavaScript -->
              </div>

              <div
                id="generate-button-container"
                class="generate-button-container"
              >
                <div id="die" class="die">🎲</div>
                <span id="generate-button" class="reroll"
                  >🖋️ <span>Generate</span></span
                >
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div id="nav-pane" class="nav-pane">
        <div id="search-container" class="search-container">
          <div class="search-input-wrapper">
            <input
              type="text"
              id="search-input"
              class="search-input"
              placeholder="Search nodes..."
            />
            <button
              id="search-clear"
              class="search-clear"
              style="display: none"
            >
              ×
            </button>
          </div>
        </div>
        <div id="loom-tree-view" class="loom-tree-view"></div>
        <!-- Search result containers - hidden by default -->
        <div
          id="search-no-results"
          class="search-no-results"
          style="display: none"
        >
          No results found
        </div>
        <div
          id="search-results-container"
          class="search-results-container"
          style="display: none"
        ></div>
      </div>
    </div>
    <script src="utils.js"></script>
    <script src="model.js"></script>
    <script src="llm-service.js"></script>
    <script src="tree-nav.js"></script>
    <script src="settings.js"></script>
    <script src="file-manager.js"></script>
    <script src="renderer.js"></script>
    <script src="search-manager.js"></script>
  </body>
</html>
